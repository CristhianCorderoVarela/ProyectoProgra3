<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane styleClass="root-pane" stylesheets="@styles_1.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="cr.ac.una.restunaclient.controller.VentanaVentasController">
    
    <top>
        <VBox spacing="10" styleClass="header-container">
            <padding><Insets bottom="20" left="30" right="30" top="20" /></padding>
            <HBox alignment="CENTER_LEFT" spacing="15">
                <Label fx:id="lblTitle" styleClass="title-label" text="Facturacion - Punto de Venta">
                    <font><Font name="System Bold" size="24" /></font>
                </Label>
                <Region HBox.hgrow="ALWAYS" />
                <Label fx:id="lblUsuario" styleClass="info-label" text="Usuario: Cajero">
                    <font><Font size="14" /></font>
                </Label>
                <Separator orientation="VERTICAL" />
                <Label fx:id="lblFechaHora" styleClass="info-label" text="01/01/2025 10:30 AM">
                    <font><Font size="14" /></font>
                </Label>
                <Button fx:id="btnVolver" onAction="#onVolver" styleClass="btn-secondary" text="Volver">
                    <font><Font size="14" /></font>
                </Button>
            </HBox>
        </VBox>
    </top>
    
    <center>
        <HBox spacing="20" BorderPane.alignment="CENTER">
            <padding><Insets bottom="20" left="30" right="30" top="20" /></padding>
            
            <VBox spacing="15" styleClass="panel-card" HBox.hgrow="ALWAYS">
                <padding><Insets bottom="20" left="20" right="20" top="20" /></padding>
                
                <HBox alignment="CENTER_LEFT" spacing="15">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label fx:id="lblOrdenInfo" styleClass="orden-label" text="Orden #0001">
                            <font><Font size="16" /></font>
                        </Label>
                        <Label fx:id="lblMesaInfo" styleClass="info-label" text="Mesa: No asignada">
                            <font><Font size="13" /></font>
                        </Label>
                    </VBox>
                    <Button fx:id="btnSeleccionarOrden" onAction="#onSeleccionarOrden" styleClass="btn-info" text="Seleccionar Orden">
                        <font><Font size="13" /></font>
                    </Button>
                </HBox>
                
                <Separator />
                
                <VBox spacing="8">
                    <Label styleClass="section-label" text="Cliente:">
                        <font><Font size="14" /></font>
                    </Label>
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <TextField fx:id="txtCliente" promptText="Nombre del cliente (opcional)" HBox.hgrow="ALWAYS">
                            <font><Font size="13" /></font>
                        </TextField>
                        <Button fx:id="btnBuscarCliente" onAction="#onBuscarCliente" prefWidth="80" styleClass="btn-secondary" text="Buscar">
                            <font><Font size="13" /></font>
                        </Button>
                    </HBox>
                </VBox>
                
                <Separator />
                
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label styleClass="section-label" text="Productos en la Orden:">
                            <font><Font size="14" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="btnAgregarProducto" onAction="#onAgregarProducto" styleClass="btn-primary" text="+ Agregar Producto">
                            <font><Font name="System Bold" size="13" /></font>
                        </Button>
                    </HBox>
                    
                    <TableView fx:id="tblProductos" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colProducto" prefWidth="250" text="Producto" />
                            <TableColumn fx:id="colCantidad" prefWidth="100" text="Cantidad" />
                            <TableColumn fx:id="colPrecio" prefWidth="120" text="Precio Unit." />
                            <TableColumn fx:id="colSubtotal" prefWidth="120" text="Subtotal" />
                            <TableColumn fx:id="colAcciones" prefWidth="100" text="Acciones" />
                        </columns>
                    </TableView>
                    
                    <HBox spacing="10">
                        <Button fx:id="btnModificarCantidad" onAction="#onModificarCantidad" styleClass="btn-primary-outline" text="Modificar Cantidad">
                            <font><Font size="12" /></font>
                        </Button>
                        <Button fx:id="btnEliminarProducto" onAction="#onEliminarProducto" styleClass="btn-danger" text="Eliminar">
                            <font><Font size="12" /></font>
                        </Button>
                    </HBox>
                </VBox>
            </VBox>
            
            <VBox prefWidth="420" spacing="15" styleClass="panel-card">
                <padding><Insets bottom="20" left="20" right="20" top="20" /></padding>
                
                <Label styleClass="section-title" text="Resumen de Venta">
                    <font><Font name="System Bold" size="18" /></font>
                </Label>
                
                <Separator />
                
                <VBox spacing="12" styleClass="summary-box">
                    <HBox alignment="CENTER_LEFT">
                        <Label styleClass="summary-label" text="Subtotal:">
                            <font><Font size="14" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblSubtotal" styleClass="summary-value" text="0.00">
                            <font><Font size="14" /></font>
                        </Label>
                    </HBox>
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <CheckBox fx:id="chkImpuestoVentas" onAction="#onCalcularTotales" selected="true" text="Impuesto de Ventas">
                            <font><Font size="13" /></font>
                        </CheckBox>
                        <Label fx:id="lblPorcentajeIV" styleClass="info-label" text="13 porciento">
                            <font><Font size="12" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblImpuestoVentas" text="0.00">
                            <font><Font size="13" /></font>
                        </Label>
                    </HBox>
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <CheckBox fx:id="chkImpuestoServicio" onAction="#onCalcularTotales" selected="true" text="Impuesto de Servicio">
                            <font><Font size="13" /></font>
                        </CheckBox>
                        <Label fx:id="lblPorcentajeIS" styleClass="info-label" text="10 porciento">
                            <font><Font size="12" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblImpuestoServicio" text="0.00">
                            <font><Font size="13" /></font>
                        </Label>
                    </HBox>
                    
                    <Separator />
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label styleClass="summary-label" text="Descuento:">
                            <font><Font size="13" /></font>
                        </Label>
                        <TextField fx:id="txtDescuento" alignment="CENTER_RIGHT" onKeyReleased="#onCalcularTotales" prefWidth="80" text="0">
                            <font><Font size="13" /></font>
                        </TextField>
                        <Label text="porciento">
                            <font><Font size="13" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblDescuento" styleClass="discount-label" text="-0.00">
                            <font><Font size="13" /></font>
                        </Label>
                    </HBox>
                    <Label fx:id="lblDescuentoMax" styleClass="info-label-small" text="Descuento maximo permitido: 15 porciento" />
                    
                    <Separator />
                    
                    <HBox alignment="CENTER_LEFT" styleClass="total-box">
                        <Label styleClass="total-label" text="TOTAL A PAGAR:">
                            <font><Font size="16" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblTotal" styleClass="total-value" text="0.00">
                            <font><Font name="System Bold" size="20" /></font>
                        </Label>
                    </HBox>
                </VBox>
                
                <Separator />
                
                <VBox spacing="12">
                    <Label styleClass="section-label" text="Metodos de Pago:">
                        <font><Font size="14" /></font>
                    </Label>
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label prefWidth="100" text="Efectivo:">
                            <font><Font size="13" /></font>
                        </Label>
                        <TextField fx:id="txtEfectivo" alignment="CENTER_RIGHT" onKeyReleased="#onCalcularVuelto" prefWidth="150" text="0.00">
                            <font><Font size="13" /></font>
                        </TextField>
                    </HBox>
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label prefWidth="100" text="Tarjeta:">
                            <font><Font size="13" /></font>
                        </Label>
                        <TextField fx:id="txtTarjeta" alignment="CENTER_RIGHT" onKeyReleased="#onCalcularVuelto" prefWidth="150" text="0.00">
                            <font><Font size="13" /></font>
                        </TextField>
                    </HBox>
                    
                    <HBox alignment="CENTER_LEFT" styleClass="change-box">
                        <Label styleClass="change-label" text="Vuelto:">
                            <font><Font size="14" /></font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblVuelto" styleClass="change-value" text="0.00">
                            <font><Font size="16" /></font>
                        </Label>
                    </HBox>
                </VBox>
                
                <Region VBox.vgrow="ALWAYS" />
                
                <VBox spacing="10">
                    <Button fx:id="btnProcesarPago" onAction="#onProcesarPago" prefHeight="50" styleClass="btn-success" text="Procesar Pago">
                        <font><Font name="System Bold" size="16" /></font>
                    </Button>
                    
                    <HBox spacing="10">
                        <Button fx:id="btnImprimir" onAction="#onImprimir" styleClass="btn-primary-outline" text="Imprimir" HBox.hgrow="ALWAYS">
                            <font><Font size="13" /></font>
                        </Button>
                        <Button fx:id="btnEnviarEmail" onAction="#onEnviarEmail" styleClass="btn-info" text="Enviar Email" HBox.hgrow="ALWAYS">
                            <font><Font size="13" /></font>
                        </Button>
                    </HBox>
                    
                    <Button fx:id="btnCancelar" onAction="#onCancelar" styleClass="btn-danger" text="Cancelar Venta">
                        <font><Font size="13" /></font>
                    </Button>
                </VBox>
            </VBox>
        </HBox>
    </center>
</BorderPane>
